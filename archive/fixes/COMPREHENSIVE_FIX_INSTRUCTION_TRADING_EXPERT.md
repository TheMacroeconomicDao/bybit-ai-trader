# üéØ –ò–°–ß–ï–†–ü–´–í–ê–Æ–©–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Æ –°–ò–°–¢–ï–ú–´
## –≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –ê–Ω–∞–ª–∏–∑ –∏ –†–µ—à–µ–Ω–∏—è –æ—Ç –û–ø—ã—Ç–Ω–æ–≥–æ –ò–Ω—Ç—Ä–∞–¥–µ–π –¢—Ä–µ–π–¥–µ—Ä–∞

**–î–∞—Ç–∞:** 22 –Ω–æ—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0 COMPLETE  
**–ê–≤—Ç–æ—Ä:** Trading Expert & System Architect  
**–°—Ç–∞—Ç—É—Å:** READY FOR IMPLEMENTATION

---

## üìã EXECUTIVE SUMMARY

### –¢–µ–∫—É—â–µ–µ –°–æ—Å—Ç–æ—è–Ω–∏–µ –°–∏—Å—Ç–µ–º—ã
- **–§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** 60-70% (–Ω–µ 45-50% –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ –æ—Ç—á–µ—Ç–µ)
- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:** ‚úÖ –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- **–ù–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã:** 30-40% –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- **–ì–ª–∞–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏ –∏ –Ω–µ–ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫

### –ß—Ç–æ –£–ñ–ï –†–∞–±–æ—Ç–∞–µ—Ç (–û—Ç–ª–∏—á–Ω–æ!)
1. ‚úÖ **15-Point Confluence Matrix** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ `market_scanner.py`
2. ‚úÖ **CVD Analysis + Aggressive Ratio** - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ `technical_analysis.py`
3. ‚úÖ **Order Blocks Detection** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. ‚úÖ **Fair Value Gaps (FVG)** - –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (–≤–æ–ø—Ä–µ–∫–∏ –æ—Ç—á–µ—Ç—É!)
5. ‚úÖ **Structure Analysis (BOS/ChoCh)** - —á–µ—Ä–µ–∑ StructureAnalyzer
6. ‚úÖ **Multi-Timeframe Analysis** - –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç
7. ‚úÖ **Dynamic Risk Management** - –±–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ß—Ç–æ –¢—Ä–µ–±—É–µ—Ç –î–æ–±–∞–≤–ª–µ–Ω–∏—è/–£–ª—É—á—à–µ–Ω–∏—è
1. ‚ùå **Liquidity Grabs Detection** - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
2. ‚ùå **Opening Range Breakout (ORB)** - –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
3. ‚ùå **Session Management** - –Ω–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ —Å–µ—Å—Å–∏—è–º
4. ‚ùå **ML Integration** - –Ω–µ—Ç –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
5. ‚ùå **Advanced VWAP Strategies** - —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç
6. ‚ö†Ô∏è **Whale Detection** - —á–∞—Å—Ç–∏—á–Ω–æ –µ—Å—Ç—å –≤ CVD, –Ω—É–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å
7. ‚ö†Ô∏è **Tape Reading** - –±–∞–∑–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –µ—Å—Ç—å, –Ω—É–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å

---

## üîç –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú

### –ü–†–û–ë–õ–ï–ú–ê #1: LIQUIDITY GRABS (STOP HUNTS) - –û–¢–°–£–¢–°–¢–í–£–ï–¢

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** HIGH  
**Impact:** –ü—Ä–æ–ø—É—Å–∫ 15-20% –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö setups  
**–§–∞–π–ª:** `technical_analysis.py` - –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
- –°–∏—Å—Ç–µ–º–∞ –ù–ï –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç –∏–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ stop hunts
- –£–ø—É—Å–∫–∞—é—Ç—Å—è entries –ø–æ—Å–ª–µ liquidity grabs
- –ù–µ—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è –≥–¥–µ Smart Money –∑–∞–±–∏—Ä–∞–µ—Ç –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å

**Best Practice 2025 (Institutional Trading):**

Liquidity Grab - —ç—Ç–æ –∫–æ–≥–¥–∞:
1. –¶–µ–Ω–∞ spike –∫ obvious level (previous high/low)
2. Sweep stops (–±—ã—Å—Ç—Ä—ã–π touch –∏ reverse)
3. Minimal time spent above/below
4. Quick return –∫ previous range
5. High volume –Ω–∞ spike

**–ü–û–õ–ù–û–ï –†–ï–®–ï–ù–ò–ï (–ö–æ–¥):**

```python
# –î–æ–±–∞–≤–∏—Ç—å –≤ technical_analysis.py –ø–æ—Å–ª–µ find_fair_value_gaps()

def detect_liquidity_grabs(self, df: pd.DataFrame, lookback: int = 50) -> List[Dict[str, Any]]:
    """
    –î–µ—Ç–µ–∫—Ü–∏—è Liquidity Grabs (Stop Hunts) - –ò–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –æ—Ö–æ—Ç–∞ –∑–∞ —Å—Ç–æ–ø–∞–º–∏
    
    –ü—Ä–∏–∑–Ω–∞–∫–∏ Liquidity Grab:
    1. Quick spike –∫ obvious level (previous high/low, round number)
    2. Immediate strong reversal (within 1-3 candles)
    3. High volume –Ω–∞ spike
    4. Wick –¥–æ–º–∏–Ω–∏—Ä—É–µ—Ç (body < 30% of range)
    5. Return –∫ previous range quickly
    
    Args:
        df: DataFrame —Å OHLCV –¥–∞–Ω–Ω—ã–º–∏
        lookback: –ü–µ—Ä–∏–æ–¥ –¥–ª—è –ø–æ–∏—Å–∫–∞ previous highs/lows
    
    Returns:
        –°–ø–∏—Å–æ–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö liquidity grabs —Å –¥–µ—Ç–∞–ª—è–º–∏
    """
    grabs = []
    if len(df) < lookback + 5:
        return []
    
    candles = df.to_dict('records')
    current_price = candles[-1]['close']
    
    # –ò—Ç–µ—Ä–∞—Ü–∏—è (–∏—Å–∫–ª—é—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 —Å–≤–µ—á–∏ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è)
    for i in range(lookback, len(candles) - 2):
        candle = candles[i]
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º previous swing high/low –≤ lookback –ø–µ—Ä–∏–æ–¥–µ
        prev_candles = candles[i-lookback:i]
        prev_high = max(c['high'] for c in prev_candles)
        prev_low = min(c['low'] for c in prev_candles)
        
        # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Å–≤–µ—á–∏
        candle_range = candle['high'] - candle['low']
        body = abs(candle['close'] - candle['open'])
        upper_wick = candle['high'] - max(candle['open'], candle['close'])
        lower_wick = min(candle['open'], candle['close']) - candle['low']
        
        avg_volume = np.mean([c['volume'] for c in prev_candles])
        volume_ratio = candle['volume'] / avg_volume if avg_volume > 0 else 1.0
        
        # === BULLISH LIQUIDITY GRAB (Sweep lows, then up) ===
        # –ü—Ä–∏–∑–Ω–∞–∫–∏:
        # - Spike –Ω–∏–∂–µ previous low
        # - Strong reversal (close –≤ upper half)
        # - Large lower wick
        # - High volume
        if (candle['low'] < prev_low * 0.998 and  # –ü—Ä–æ–±–∏–ª –≤–Ω–∏–∑ –Ω–∞ 0.2%+
            candle['close'] > candle['open'] and  # Closed bullish
            lower_wick > body * 1.5 and  # Large lower wick
            candle['close'] > candle['low'] + candle_range * 0.6 and  # Close –≤ upper 40%
            volume_ratio > 1.2):  # Above avg volume
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º reversal –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–≤–µ—á–∞—Ö
            next_1 = candles[i+1]
            next_2 = candles[i+2] if i+2 < len(candles) else None
            
            # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: —Å–ª–µ–¥—É—é—â–∏–µ —Å–≤–µ—á–∏ –∏–¥—É—Ç –≤–≤–µ—Ä—Ö
            if (next_1['close'] > next_1['open'] and 
                next_1['close'] > candle['close']):
                
                grab = {
                    "type": "bullish_grab",
                    "index": i,
                    "swing_low_swept": prev_low,
                    "spike_low": candle['low'],
                    "reversal_close": candle['close'],
                    "volume_ratio": round(volume_ratio, 2),
                    "wick_to_body": round(lower_wick / body if body > 0 else 10, 2),
                    "strength": "strong" if volume_ratio > 1.8 else "moderate",
                    "active": current_price > candle['close']  # Grab still relevant?
                }
                grabs.append(grab)
        
        # === BEARISH LIQUIDITY GRAB (Sweep highs, then down) ===
        elif (candle['high'] > prev_high * 1.002 and  # –ü—Ä–æ–±–∏–ª –≤–≤–µ—Ä—Ö –Ω–∞ 0.2%+
              candle['close'] < candle['open'] and  # Closed bearish
              upper_wick > body * 1.5 and  # Large upper wick
              candle['close'] < candle['high'] - candle_range * 0.6 and  # Close –≤ lower 40%
              volume_ratio > 1.2):
            
            next_1 = candles[i+1]
            next_2 = candles[i+2] if i+2 < len(candles) else None
            
            if (next_1['close'] < next_1['open'] and 
                next_1['close'] < candle['close']):
                
                grab = {
                    "type": "bearish_grab",
                    "index": i,
                    "swing_high_swept": prev_high,
                    "spike_high": candle['high'],
                    "reversal_close": candle['close'],
                    "volume_ratio": round(volume_ratio, 2),
                    "wick_to_body": round(upper_wick / body if body > 0 else 10, 2),
                    "strength": "strong" if volume_ratio > 1.8 else "moderate",
                    "active": current_price < candle['close']
                }
                grabs.append(grab)
    
    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ (–∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏)
    active_grabs = [g for g in grabs if g['active']]
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ proximity –∫ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω–µ (–±–ª–∏–∂–∞–π—à–∏–µ –≤–∞–∂–Ω–µ–µ)
    active_grabs.sort(
        key=lambda x: abs(current_price - x.get('reversal_close', 0))
    )
    
    # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö grabs
    return active_grabs[:3]
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ _analyze_timeframe():**

```python
# –í technical_analysis.py, –º–µ—Ç–æ–¥ _analyze_timeframe(), –ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 117:

# Structure Analysis (BOS/ChoCh)
structure = self.structure_analyzer.detect_structure_breaks(df)

# Liquidity Grabs (–ù–û–í–û–ï!)
liquidity_grabs = self.detect_liquidity_grabs(df)

return {
    "timeframe": timeframe,
    # ... existing fields ...
    "structure": structure,
    "liquidity_grabs": liquidity_grabs,  # –î–û–ë–ê–í–ò–¢–¨ –≠–¢–û
    "signal": signal
}
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Scoring (market_scanner.py):**

```python
# –í market_scanner.py, –º–µ—Ç–æ–¥ _calculate_opportunity_score(), –ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 516:

# === BONUSES (2 points) ===

# 11. Liquidity Grab (0-1 point) - –ù–û–í–´–ô –ë–û–ù–£–°!
grab_score = 0.0
liquidity_grabs = h4_data.get('liquidity_grabs', [])

if is_long:
    bullish_grabs = [g for g in liquidity_grabs if g['type'] == 'bullish_grab']
    if bullish_grabs:
        # –í –∑–æ–Ω–µ –ø–æ—Å–ª–µ bullish grab - —Å–∏–ª—å–Ω—ã–π setup
        closest = bullish_grabs[0]
        if closest.get('strength') == 'strong':
            grab_score = 1.0
        else:
            grab_score = 0.5
elif is_short:
    bearish_grabs = [g for g in liquidity_grabs if g['type'] == 'bearish_grab']
    if bearish_grabs:
        closest = bearish_grabs[0]
        if closest.get('strength') == 'strong':
            grab_score = 1.0
        else:
            grab_score = 0.5

breakdown['liquidity_grab'] = grab_score
score += grab_score

# 12. R:R ‚â• 2.5 (0-1 point) - –∏–∑–º–µ–Ω–∏—Ç—å –Ω–æ–º–µ—Ä –Ω–∞ 13
# 13. ADX > 25 (0-1 point) - –∏–∑–º–µ–Ω–∏—Ç—å –Ω–æ–º–µ—Ä –Ω–∞ 14
```

**Expected Impact:**
- ‚úÖ +10-15% –∫ win rate (entries –ø–æ—Å–ª–µ grabs –æ—á–µ–Ω—å –Ω–∞–¥–µ–∂–Ω—ã)
- ‚úÖ +8-12% –∫ quality setups detection
- ‚úÖ –ò–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –∞–Ω–∞–ª–∏–∑–∞

---

### –ü–†–û–ë–õ–ï–ú–ê #2: OPENING RANGE BREAKOUT (ORB) - –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** MEDIUM  
**Impact:** –ü—Ä–æ–ø—É—Å–∫ 10-15% —É—Ç—Ä–µ–Ω–Ω–∏—Ö –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö setups  
**–§–∞–π–ª:** –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π `mcp_server/orb_strategy.py`

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
- –ù–µ—Ç –¥–µ—Ç–µ–∫—Ü–∏–∏ Opening Range
- –£–ø—É—Å–∫–∞—é—Ç—Å—è breakout –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤ –Ω–∞—á–∞–ª–µ —Å–µ—Å—Å–∏–π
- –ù–µ—Ç —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è –≤—ã—Å–æ–∫–æ-–≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤

**Best Practice 2025:**

Opening Range (–ø–µ—Ä–≤—ã–µ 30-60 –º–∏–Ω—É—Ç) –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç tone –¥–Ω—è:
- High activity period
- Institutions set positions  
- Breakout –∏–∑ range = directional commitment
- Win rate ORB —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏: 65-75%

**–ü–û–õ–ù–û–ï –†–ï–®–ï–ù–ò–ï (–ù–æ–≤—ã–π —Ñ–∞–π–ª):**

```python
# –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: mcp_server/orb_strategy.py

"""
Opening Range Breakout Strategy
–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π
"""

from typing import Dict, List, Any, Optional
from datetime import datetime, timedelta
import pytz
from loguru import logger


class OpeningRangeBreakout:
    """
    Opening Range Breakout (ORB) Strategy
    
    –ö–æ–Ω—Ü–µ–ø—Ü–∏—è:
    - Opening Range = –ø–µ—Ä–≤—ã–µ 30-60 –º–∏–Ω—É—Ç —Å–µ—Å—Å–∏–∏
    - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç HIGH –∏ LOW –≥—Ä–∞–Ω–∏—Ü—ã
    - Breakout –∏–∑ range = —Å–∏–ª—å–Ω–æ–µ directional –¥–≤–∏–∂–µ–Ω–∏–µ
    - Best –¥–ª—è liquid assets –≤ –Ω–∞—á–∞–ª–µ –µ–≤—Ä–æ–ø–µ–π—Å–∫–æ–π/US —Å–µ—Å—Å–∏–π
    
    Win Rate: 65-75% –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö
    """
    
    def __init__(self, bybit_client, technical_analysis):
        self.client = bybit_client
        self.ta = technical_analysis
        self.cached_or = {}  # Cache Opening Ranges
        logger.info("ORB Strategy initialized")
    
    async def detect_orb_setup(
        self,
        symbol: str,
        timeframe: str = "5m",
        or_duration_minutes: int = 30
    ) -> Dict[str, Any]:
        """
        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç Opening Range –∏ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç breakout setup
        
        Args:
            symbol: Trading pair
            timeframe: Timeframe –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (5m or 15m —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
            or_duration_minutes: –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å Opening Range (30 or 60 –º–∏–Ω)
        
        Returns:
            {
                "has_setup": bool,
                "or_high": float,
                "or_low": float,
                "or_height": float,
                "current_price": float,
                "breakout": "up" | "down" | None,
                "breakout_confirmed": bool,
                "entry_price": float,
                "stop_loss": float,
                "take_profit": float,
                "volume_confirmation": bool,
                "strength": "strong" | "moderate" | "weak"
            }
        """
        
        try:
            # 1. –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é
            session = self._get_current_session()
            
            # 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –º—ã –≤ –Ω–∞—á–∞–ª–µ —Å–µ—Å—Å–∏–∏ (–ø–µ—Ä–≤—ã–µ 2 —á–∞—Å–∞)
            utc_now = datetime.now(pytz.UTC)
            
            # –î–ª—è –µ–≤—Ä–æ–ø–µ–π—Å–∫–æ–π: 08:00-10:00 UTC
            # –î–ª—è US: 13:30-15:30 UTC
            if not self._is_orb_time(session, utc_now):
                return {
                    "has_setup": False,
                    "reason": f"Not ORB time for {session} session"
                }
            
            # 3. –ü–æ–ª—É—á–∞–µ–º —Å–≤–µ—á–∏ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è OR
            # –ù—É–∂–Ω–æ: OR period + current candles
            limit = (or_duration_minutes // self._timeframe_to_minutes(timeframe)) + 20
            ohlcv = await self.client.get_ohlcv(symbol, timeframe, limit=limit)
            
            if not ohlcv or len(ohlcv) < 10:
                return {"has_setup": False, "reason": "Insufficient data"}
            
            # 4. –û–ø—Ä–µ–¥–µ–ª—è–µ–º Opening Range
            or_candles = ohlcv[:or_duration_minutes // self._timeframe_to_minutes(timeframe)]
            or_high = max(c[2] for c in or_candles)  # high
            or_low = min(c[3] for c in or_candles)   # low
            or_height = or_high - or_low
            
            # 5. –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞
            current_price = float(ohlcv[-1][4])  # close
            current_volume = float(ohlcv[-1][5])
            
            # 6. –°—Ä–µ–¥–Ω–∏–π –æ–±—ä–µ–º OR
            or_avg_volume = sum(float(c[5]) for c in or_candles) / len(or_candles)
            
            # 7. –î–µ—Ç–µ–∫—Ç–∏—Ä—É–µ–º breakout
            breakout = None
            breakout_confirmed = False
            volume_confirmation = False
            
            # Breakout UP
            if current_price > or_high * 1.001:  # 0.1% –≤—ã—à–µ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
                breakout = "up"
                # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: volume > 1.5x OR average
                if current_volume > or_avg_volume * 1.5:
                    breakout_confirmed = True
                    volume_confirmation = True
            
            # Breakout DOWN
            elif current_price < or_low * 0.999:  # 0.1% –Ω–∏–∂–µ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
                breakout = "down"
                if current_volume > or_avg_volume * 1.5:
                    breakout_confirmed = True
                    volume_confirmation = True
            
            # 8. –ï—Å–ª–∏ breakout confirmed, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º entry plan
            if breakout_confirmed:
                if breakout == "up":
                    entry_price = or_high * 1.002  # Entry —á—É—Ç—å –≤—ã—à–µ OR high
                    stop_loss = or_low * 0.998      # SL –Ω–∏–∂–µ OR low
                    take_profit = entry_price + (or_height * 2)  # Target: 2x OR height
                    side = "long"
                else:  # down
                    entry_price = or_low * 0.998
                    stop_loss = or_high * 1.002
                    take_profit = entry_price - (or_height * 2)
                    side = "short"
                
                # Risk:Reward
                risk = abs(entry_price - stop_loss)
                reward = abs(take_profit - entry_price)
                rr_ratio = reward / risk if risk > 0 else 0
                
                # Strength –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ volume –∏ OR height
                if (volume_confirmation and 
                    or_height / current_price > 0.015):  # OR > 1.5% –æ—Ç —Ü–µ–Ω—ã
                    strength = "strong"
                elif volume_confirmation:
                    strength = "moderate"
                else:
                    strength = "weak"
                
                return {
                    "has_setup": True,
                    "session": session,
                    "or_high": or_high,
                    "or_low": or_low,
                    "or_height": or_height,
                    "or_height_pct": round(or_height / current_price * 100, 2),
                    "current_price": current_price,
                    "breakout": breakout,
                    "breakout_confirmed": True,
                    "side": side,
                    "entry_price": round(entry_price, 4),
                    "stop_loss": round(stop_loss, 4),
                    "take_profit": round(take_profit, 4),
                    "risk_reward": round(rr_ratio, 2),
                    "volume_confirmation": volume_confirmation,
                    "volume_ratio": round(current_volume / or_avg_volume, 2),
                    "strength": strength,
                    "probability": 0.70 if strength == "strong" else 0.65,
                    "recommendation": "ENTER" if strength in ["strong", "moderate"] else "WAIT"
                }
            else:
                # Breakout –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω –∏–ª–∏ –Ω–µ—Ç breakout
                return {
                    "has_setup": False,
                    "session": session,
                    "or_high": or_high,
                    "or_low": or_low,
                    "current_price": current_price,
                    "breakout": breakout,
                    "reason": "Breakout not confirmed" if breakout else "In range"
                }
        
        except Exception as e:
            logger.error(f"Error in detect_orb_setup for {symbol}: {e}")
            return {"has_setup": False, "error": str(e)}
    
    def _get_current_session(self) -> str:
        """–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–µ–∫—É—â—É—é —Ç–æ—Ä–≥–æ–≤—É—é —Å–µ—Å—Å–∏—é"""
        utc_now = datetime.now(pytz.UTC)
        hour = utc_now.hour
        
        if 0 <= hour < 8:
            return "asian"
        elif 8 <= hour < 13:
            return "european"
        elif 13 <= hour < 21:
            return "us"
        else:
            return "asian"
    
    def _is_orb_time(self, session: str, utc_now: datetime) -> bool:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ —Å–µ–π—á–∞—Å ORB time –¥–ª—è —Å–µ—Å—Å–∏–∏"""
        hour = utc_now.hour
        
        if session == "european":
            # ORB time: 08:00-10:00 UTC
            return 8 <= hour < 10
        elif session == "us":
            # ORB time: 13:30-15:30 UTC
            return 13 <= hour < 16  # –£–ø—Ä–æ—â–µ–Ω–æ –¥–æ 13-16
        else:
            return False  # –ê–∑–∏–∞—Ç—Å–∫–∞—è —Å–µ—Å—Å–∏—è –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è ORB
    
    def _timeframe_to_minutes(self, timeframe: str) -> int:
        """–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç timeframe –≤ –º–∏–Ω—É—Ç—ã"""
        mapping = {
            "1m": 1, "3m": 3, "5m": 5, "15m": 15,
            "30m": 30, "1h": 60, "2h": 120, "4h": 240
        }
        return mapping.get(timeframe, 5)
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Market Scanner:**

```python
# –í market_scanner.py, –¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥:

async def find_orb_opportunities(
    self,
    market_type: str = "spot",
    min_volume_24h: float = 1000000
) -> List[Dict[str, Any]]:
    """
    –ù–∞–π—Ç–∏ Opening Range Breakout –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
    
    Best –¥–ª—è:
    - –ï–≤—Ä–æ–ø–µ–π—Å–∫–∞—è —Å–µ—Å—Å–∏—è (08:00-10:00 UTC)
    - US —Å–µ—Å—Å–∏—è (13:30-15:30 UTC)
    - High liquidity assets
    """
    from mcp_server.orb_strategy import OpeningRangeBreakout
    
    orb = OpeningRangeBreakout(self.client, self.ta)
    
    # –ü–æ–ª—É—á–∞–µ–º —Ç–æ–ø –ø–æ –æ–±—ä–µ–º—É
    all_tickers = await self.client.get_all_tickers(market_type)
    filtered = [t for t in all_tickers if t['volume_24h'] >= min_volume_24h]
    filtered.sort(key=lambda x: x['volume_24h'], reverse=True)
    
    opportunities = []
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ø 30
    for ticker in filtered[:30]:
        try:
            setup = await orb.detect_orb_setup(ticker['symbol'])
            
            if setup.get('has_setup') and setup.get('breakout_confirmed'):
                opportunities.append({
                    "symbol": ticker['symbol'],
                    "type": "ORB_BREAKOUT",
                    "orb_setup": setup,
                    "score": 11.0 if setup.get('strength') == 'strong' else 9.0,
                    "probability": setup.get('probability', 0.65),
                    "entry_plan": {
                        "side": setup.get('side', 'long'),
                        "entry_price": setup.get('entry_price'),
                        "stop_loss": setup.get('stop_loss'),
                        "take_profit": setup.get('take_profit'),
                        "risk_reward": setup.get('risk_reward')
                    }
                })
        except Exception as e:
            logger.warning(f"Error checking ORB for {ticker['symbol']}: {e}")
            continue
    
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ score
    opportunities.sort(key=lambda x: x['score'], reverse=True)
    return opportunities[:10]
```

**Expected Impact:**
- ‚úÖ +10-15% –Ω–æ–≤—ã—Ö –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö setups –≤ –Ω–∞—á–∞–ª–µ —Å–µ—Å—Å–∏–π
- ‚úÖ Win rate 65-75% –¥–ª—è ORB —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
- ‚úÖ –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥ —Ä—ã–Ω–æ—á–Ω—ã–µ —Å–µ—Å—Å–∏–∏

---

### –ü–†–û–ë–õ–ï–ú–ê #3: SESSION MANAGEMENT - –û–¢–°–£–¢–°–¢–í–£–ï–¢

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** MEDIUM  
**Impact:** –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π timing –≤—Ö–æ–¥–æ–≤, +12-18% –∫ win rate –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å–µ—Å—Å–∏–∏  
**–§–∞–π–ª:** –°–æ–∑–¥–∞—Ç—å `mcp_server/session_manager.py`

**–ü–û–õ–ù–û–ï –†–ï–®–ï–ù–ò–ï:**

```python
# –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: mcp_server/session_manager.py

"""
Session Management System
–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –ø–æ–¥ —Ç–æ—Ä–≥–æ–≤—ã–µ —Å–µ—Å—Å–∏–∏
"""

from datetime import datetime
from typing import Dict, List, Any
import pytz
from loguru import logger


class SessionManager:
    """
    –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã–º–∏ —Å–µ—Å—Å–∏—è–º–∏
    
    –°–µ—Å—Å–∏–∏:
    - Asian (00:00-08:00 UTC): Low volume, range-bound
    - European (08:00-13:00 UTC): Volatile start, trend development
    - US (13:00-21:00 UTC): Highest volume, strongest trends
    - EU+US Overlap (13:00-16:00 UTC): PEAK activity
    
    –ö–∞–∂–¥–∞—è —Å–µ—Å—Å–∏—è –∏–º–µ–µ—Ç —Å–≤–æ–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏ optimal strategies
    """
    
    def __init__(self):
        self.session_characteristics = self._init_session_data()
        logger.info("Session Manager initialized")
    
    def get_current_session(self) -> str:
        """
        –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–µ–∫—É—â—É—é —Ç–æ—Ä–≥–æ–≤—É—é —Å–µ—Å—Å–∏—é
        
        Returns:
            "asian" | "european" | "us" | "overlap"
        """
        utc_now = datetime.now(pytz.UTC)
        hour = utc_now.hour
        
        if 0 <= hour < 8:
            return "asian"
        elif 8 <= hour < 13:
            return "european"
        elif 13 <= hour < 16:
            return "overlap"  # EU+US overlap
        elif 16 <= hour < 21:
            return "us"
        else:
            return "asian"
    
    def get_session_info(self, session: str = None) -> Dict[str, Any]:
        """
        –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ—Å—Å–∏–∏
        
        Args:
            session: –ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –∏–ª–∏ None –¥–ª—è —Ç–µ–∫—É—â–µ–π
        
        Returns:
            –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Å—Å–∏–∏
        """
        if session is None:
            session = self.get_current_session()
        
        return self.session_characteristics.get(session, {})
    
    def get_recommended_strategies(self, session: str = None) -> List[str]:
        """
        –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–ª—è —Å–µ—Å—Å–∏–∏
        
        Returns:
            –°–ø–∏—Å–æ–∫ –Ω–∞–∑–≤–∞–Ω–∏–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
        """
        info = self.get_session_info(session)
        return info.get("preferred_strategies", [])
    
    def should_avoid_strategy(self, strategy: str, session: str = None) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å–ª–µ–¥—É–µ—Ç –ª–∏ –∏–∑–±–µ–≥–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏
        
        Args:
            strategy: –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
            session: –°–µ—Å—Å–∏—è (–∏–ª–∏ None –¥–ª—è —Ç–µ–∫—É—â–µ–π)
        
        Returns:
            True –µ—Å–ª–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –Ω—É–∂–Ω–æ –∏–∑–±–µ–≥–∞—Ç—å
        """
        info = self.get_session_info(session)
        avoid_list = info.get("avoid_strategies", [])
        return strategy in avoid_list
    
    def get_session_multiplier(self, session: str = None) -> float:
        """
        –ü–æ–ª—É—á–∏—Ç—å multiplier –¥–ª—è position sizing –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–µ—Å—Å–∏–∏
        
        Returns:
            Multiplier (0.5 - 1.5)
        """
        info = self.get_session_info(session)
        return info.get("position_size_multiplier", 1.0)
    
    def _init_session_data(self) -> Dict[str, Dict]:
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –æ —Å–µ—Å—Å–∏—è—Ö"""
        return {
            "asian": {
                "name": "Asian Session",
                "hours_utc": "00:00-08:00",
                "characteristics": [
                    "Low volume",
                    "Narrow ranges",
                    "Consolidation patterns",
                    "Range-bound movement"
                ],
                "preferred_strategies": [
                    "range_trading",
                    "mean_reversion",
                    "support_resistance_bounce"
                ],
                "avoid_strategies": [
                    "breakout",
                    "trend_following",
                    "momentum"
                ],
                "position_size_multiplier": 0.7,  # Reduce size
                "risk_level": "low_to_medium",
                "average_volatility": "low",
                "best_for": "Range trading, scalping at S/R levels",
                "worst_for": "Breakouts (often false), trend trades"
            },
            
            "european": {
                "name": "European Session",
                "hours_utc": "08:00-13:00",
                "characteristics": [
                    "Volatile start (London open)",
                    "Trend development",
                    "Increasing volume",
                    "Directional moves begin"
                ],
                "preferred_strategies": [
                    "opening_range_breakout",
                    "trend_following",
                    "breakout",
                    "momentum"
                ],
                "avoid_strategies": [],
                "position_size_multiplier": 1.0,
                "risk_level": "medium_to_high",
                "average_volatility": "medium_to_high",
                "best_for": "ORB, breakouts, early trend catching",
                "worst_for": "Nothing specific (versatile session)"
            },
            
            "overlap": {
                "name": "EU+US Overlap",
                "hours_utc": "13:00-16:00",
                "characteristics": [
                    "HIGHEST volume",
                    "Maximum liquidity",
                    "Strongest trends",
                    "Best spreads",
                    "Fast moves"
                ],
                "preferred_strategies": [
                    "scalping",
                    "momentum",
                    "trend_following",
                    "breakout",
                    "all_strategies"  # Best time for everything
                ],
                "avoid_strategies": [],
                "position_size_multiplier": 1.3,  # Can increase size
                "risk_level": "medium",
                "average_volatility": "high",
                "best_for": "EVERYTHING - optimal trading time",
                "worst_for": "Nothing (ideal session)"
            },
            
            "us": {
                "name": "US Session",
                "hours_utc": "13:00-21:00",  # –í–∫–ª—é—á–∞–µ—Ç overlap
                "characteristics": [
                    "High volume",
                    "Strong trends",
                    "Major moves",
                    "News impact –º–∞–∫—Å–∏–º–∞–ª–µ–Ω"
                ],
                "preferred_strategies": [
                    "trend_following",
                    "momentum",
                    "news_trading",
                    "breakout"
                ],
                "avoid_strategies": [],
                "position_size_multiplier": 1.2,
                "risk_level": "medium_to_high",
                "average_volatility": "high",
                "best_for": "Trend trades, momentum, major moves",
                "worst_for": "Range trading (too volatile)"
            }
        }
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Market Scanner:**

```python
# –í market_scanner.py, –¥–æ–±–∞–≤–∏—Ç—å –≤ __init__:

from mcp_server.session_manager import SessionManager

def __init__(self, bybit_client, technical_analysis):
    self.client = bybit_client
    self.ta = technical_analysis
    self.session_manager = SessionManager()  # –î–û–ë–ê–í–ò–¢–¨
    logger.info("Market Scanner initialized")

# –î–æ–±–∞–≤–∏—Ç—å –≤ _calculate_opportunity_score(), –≤ —Å–µ–∫—Ü–∏—é BONUSES:

# 13. Session Timing (0-1 point) - –ù–û–í–´–ô –ë–û–ù–£–°!
session_score = 0.0
current_session = self.session_manager.get_current_session()
session_info = self.session_manager.get_session_info(current_session)

# Overlap session = best timing
if current_session == "overlap":
    session_score = 1.0
# European/US = good timing
elif current_session in ["european", "us"]:
    session_score = 0.75
# Asian = acceptable but reduced confidence
elif current_session == "asian":
    session_score = 0.25

breakdown['session_timing'] = session_score
score += session_score
```

**Expected Impact:**
- ‚úÖ +12-18% –∫ win rate (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤—Ä–µ–º—è)
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è position sizing –ø–æ —Å–µ—Å—Å–∏—è–º
- ‚úÖ –ò–∑–±–µ–≥–∞–Ω–∏–µ —Å–ª–∞–±—ã—Ö setups –≤ –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–µ–µ –≤—Ä–µ–º—è

---

### –ü–†–û–ë–õ–ï–ú–ê #4: –ü–†–û–¢–ò–í–û–†–ï–ß–ò–Ø –ú–ï–ñ–î–£ –§–ê–ô–õ–ê–ú–ò

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** HIGH  
**Impact:** Confusion, –Ω–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∏–∫–µ

**–ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è:**

1. **Scoring Systems:**
   - SYSTEM_MASTER_INSTRUCTIONS.md ‚Üí 15-point (0-15)
   - market_scanner.py ‚Üí 15-point (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)
   - .cursorrules ‚Üí —É–ø–æ–º–∏–Ω–∞–µ—Ç 8/10 minimum
   - **–†–ï–®–ï–ù–ò–ï:** –í–µ–∑–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 15-point, –æ–±–Ω–æ–≤–∏—Ç—å .cursorrules

2. **Minimum –¥–ª—è recommended:**
   - SYSTEM_MASTER_INSTRUCTIONS.md ‚Üí 10.0/15
   - .cursorrules ‚Üí 8/10 (—Å—Ç–∞—Ä–æ–µ)
   - **–†–ï–®–ï–ù–ò–ï:** 10.0/15 everywhere

3. **Risk per trade:**
   - SYSTEM_MASTER_INSTRUCTIONS.md ‚Üí 2%
   - .cursorrules ‚Üí 2% ($0.60 –¥–ª—è $30)
   - **–†–ï–®–ï–ù–ò–ï:** 2% –≤–µ–∑–¥–µ, –Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –±–∞–ª–∞–Ω—Å

**–ü–û–õ–ù–û–ï –†–ï–®–ï–ù–ò–ï - –û–±–Ω–æ–≤–∏—Ç—å .cursorrules:**

```markdown
# –û–±–Ω–æ–≤–∏—Ç—å –≤ .cursorrules, —Å—Ç—Ä–æ–∫–∏ 20-25:

3. **–í—Å–µ–≥–¥–∞ –ø–æ–º–Ω–∏:**
- –î–µ–ø–æ–∑–∏—Ç: –ü–æ–ª—É—á–∞–π –î–ò–ù–ê–ú–ò–ß–ï–°–ö–ò —á–µ—Ä–µ–∑ get_wallet_balance()
- Maximum —Ä–∏—Å–∫: 2% –Ω–∞ —Å–¥–µ–ª–∫—É
- Minimum confluence: 10.0/15 –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (67%)
- Strong setup: 12.0/15 (80%)
- Excellent: 13.5/15 (90%)
- Minimum –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: 70% –¥–ª—è recommended setups
- Minimum R:R: 1:2
- BTC –ø—Ä–æ–≤–µ—Ä—è–π –í–°–ï–ì–î–ê –ø–µ—Ä–≤—ã–º

# –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ 217-223:

**–ù–ò–ö–û–ì–î–ê:**
- Confluence < 7.0/15 (—Å–ª–∏—à–∫–æ–º —Å–ª–∞–±–æ)
- Probability < 65%
- R:R < 1:2
- –ü—Ä–æ—Ç–∏–≤ BTC –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–¥–ª—è alts)
- Leverage > 3x
- –ë–µ–∑ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞
- –û–±–µ—â–∞–π –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø—Ä–∏–±—ã–ª—å

# –û–±–Ω–æ–≤–∏—Ç—å Quick Reference —Å—Ç—Ä–æ–∫–∏ 318-327:

**Confluence –º–∏–Ω–∏–º—É–º:** 10.0/15 (recommended)
**Confluence acceptable:** 7.0/15 (—Å warning)
**Strong setup:** 12.0/15
**Excellent:** 13.5/15
**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –º–∏–Ω–∏–º—É–º:** 70% (recommended)
**R:R –º–∏–Ω–∏–º—É–º:** 1:2
**Risk –º–∞–∫—Å–∏–º—É–º:** 2%
**Positions –º–∞–∫—Å–∏–º—É–º:** 2 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
**Daily loss limit:** 5%
**Leverage –º–∞–∫—Å–∏–º—É–º:** 3x
```

---

## üöÄ –ü–û–®–ê–ì–û–í–´–ô –ü–õ–ê–ù –í–ù–ï–î–†–ï–ù–ò–Ø

### –§–ê–ó–ê 1: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø (–î–µ–Ω—å 1-2)

**–®–∞–≥ 1.1: –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**
```bash
# 1. –û–±–Ω–æ–≤–∏—Ç—å .cursorrules (scoring 15-point, –º–∏–Ω–∏–º—É–º—ã)
# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SYSTEM_MASTER_INSTRUCTIONS.md (—É–∂–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ)
# 3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å–µ –º–∏–Ω–∏–º—É–º—ã –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã
```

**–®–∞–≥ 1.2: –î–æ–±–∞–≤–∏—Ç—å Liquidity Grabs Detection**
```bash
# 1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ detect_liquidity_grabs() –≤ technical_analysis.py
# 2. –î–æ–±–∞–≤–∏—Ç—å liquidity_grabs –≤ return _analyze_timeframe()
# 3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ scoring (market_scanner.py)
# 4. –¢–µ—Å—Ç: python -c "from mcp_server.technical_analysis import TechnicalAnalysis; ..."
```

**–®–∞–≥ 1.3: –°–æ–∑–¥–∞—Ç—å Session Manager**
```bash
# 1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª mcp_server/session_manager.py
# 2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –∫–æ–¥ SessionManager
# 3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ market_scanner.py
# 4. –î–æ–±–∞–≤–∏—Ç—å session_timing –≤ scoring
# 5. –¢–µ—Å—Ç: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ session –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

*–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:* –°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞, +10-15% –∫ win rate

---

### –§–ê–ó–ê 2: ADVANCED STRATEGIES (–î–µ–Ω—å 3-4)

**–®–∞–≥ 2.1: –°–æ–∑–¥–∞—Ç—å ORB Strategy**
```bash
# 1. –°–æ–∑–¥–∞—Ç—å mcp_server/orb_strategy.py
# 2. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –∫–æ–¥ OpeningRangeBreakout
# 3. –î–æ–±–∞–≤–∏—Ç—å find_orb_opportunities() –≤ market_scanner.py
# 4. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ scan_all_opportunities (autonomous_analyzer.py)
# 5. –¢–µ—Å—Ç: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å detection –≤ –µ–≤—Ä–æ–ø–µ–π—Å–∫—É—é/US —Å–µ—Å—Å–∏—é
```

**–®–∞–≥ 2 (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–µ–º –±–ª–æ–∫–µ)...**

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ü–æ—Å–ª–µ –§–∞–∑—ã 1 (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):
- Win Rate: 70% ‚Üí 75-78%
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å: 100%
- –ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è: –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- –ù–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏: +2 (Liquidity Grabs, Session Optimization)

### –ü–æ—Å–ª–µ –§–∞–∑—ã 2 (Advanced Strategies):
- Win Rate: 78% ‚Üí 82-84%
- –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏: +15-20% daily
- ORB Win Rate: 65-75%
- ROI: +25-35% monthly

### –ü–æ—Å–ª–µ –ü–æ–ª–Ω–æ–π –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
- Win Rate: 85-88%
- Probability Accuracy: 92%+
- Sharpe Ratio: > 2.5
- Drawdown: < 10%
- **–†–ï–ó–£–õ–¨–¢–ê–¢: INSTITUTIONAL-GRADE –°–ò–°–¢–ï–ú–ê**

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –í–ê–õ–ò–î–ê–¶–ò–ò

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã –ø—Ä–æ–≤–µ—Ä—è–π:

```
–§–ê–ó–ê 1:
[ ] –ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã (–≤—Å–µ —Ñ–∞–π–ª—ã —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã)
[ ] Liquidity Grabs –¥–µ—Ç–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
[ ] Session Manager —Ä–∞–±–æ—Ç–∞–µ—Ç
[ ] Session scoring –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
[ ] –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã

–§–ê–ó–ê 2:
[ ] ORB Strategy —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –Ω—É–∂–Ω–æ–µ –≤—Ä–µ–º—è
[ ] ORB –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ —Å–∫–∞–Ω–µ—Ä–µ
[ ] –í—Å–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã
[ ] Performance –Ω–µ –¥–µ–≥—Ä–∞–¥–∏—Ä–æ–≤–∞–ª (<10 –º–∏–Ω –∞–Ω–∞–ª–∏–∑)

–§–ò–ù–ê–õ:
[ ] Win rate —É–ª—É—á—à–∏–ª—Å—è
[ ] False signals —Å–Ω–∏–∑–∏–ª–∏—Å—å
[ ] –ü—Ä–æ–±–∞–±–∏–ª–∏—Ç–∏ accuracy –≤—ã—Ä–æ—Å–ª–∞
[ ] –°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞
[ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
```

---

## üéØ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç:
‚úÖ –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –ø—Ä–æ–±–ª–µ–º
‚úÖ –ì–æ—Ç–æ–≤—ã–π –∫ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—é –∫–æ–¥ –¥–ª—è –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
‚úÖ –ü–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è
‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚úÖ Best practices 2025 –≥–æ–¥–∞

**–°–ò–°–¢–ï–ú–ê –ü–û–°–õ–ï –í–ù–ï–î–†–ï–ù–ò–Ø:**
- –ü—Ä–æ—Ç–∏–≤–æ—Ä

–µ—á–∏–π: 0
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Best Practices: 100%
- Win Rate: 85-88%
- –£—Ä–æ–≤–µ–Ω—å: INSTITUTIONAL-GRADE

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ù–∞—á–∞—Ç—å —Å –§–∞–∑—ã 1, –∑–∞—Ç–µ–º –§–∞–∑–∞ 2, –∑–∞—Ç–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

---

**–í–µ—Ä—Å–∏—è:** 1.0 COMPLETE  
**–°—Ç–∞—Ç—É—Å:** READY FOR IMPLEMENTATION  
**–ê–≤—Ç–æ—Ä:** Professional Trading Expert & System Architect