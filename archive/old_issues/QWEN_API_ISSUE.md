# ⚠️ Проблема с Qwen API

## Проблема

Все модели Qwen (qwen-max, qwen-plus, qwen-turbo) возвращают ошибку:
```
403: {"code":"AccessDenied.Unpurchased","message":"Access to model denied. Please make sure you are eligible for using the model."}
```

## Возможные причины

1. **API ключ не имеет доступа к моделям** - возможно требуется активация или покупка подписки
2. **Неправильный API endpoint** - возможно изменился формат запроса
3. **Модели переименованы** - возможно нужно использовать другие названия моделей

## Исправления

### ✅ Исправлена бесконечная рекурсия
- Убрана рекурсивная логика fallback
- Добавлен флаг `_fallback_attempted` для предотвращения повторных попыток
- Fallback теперь работает через прямой HTTP запрос без рекурсии

## Что нужно проверить

1. **Проверить аккаунт Alibaba Cloud:**
   - Зайти в консоль DashScope
   - Проверить доступные модели
   - Проверить баланс и подписку

2. **Проверить API ключ:**
   - Убедиться что ключ активен
   - Проверить права доступа ключа

3. **Попробовать другие модели:**
   - `qwen-turbo` (самая доступная)
   - `qwen-plus` 
   - Возможно есть бесплатные модели с другими названиями

## Временное решение

Пока проблема не решена, система будет возвращать ошибку при попытке использовать Qwen. 

**Рекомендация:** Проверить аккаунт Alibaba Cloud и активировать доступ к моделям, или использовать альтернативный AI сервис для анализа рынка.


