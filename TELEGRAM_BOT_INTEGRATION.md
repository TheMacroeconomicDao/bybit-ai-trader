# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Telegram Bot –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤

## üìã –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ Telegram –∫–∞–Ω–∞–ª—ã/–≥—Ä—É–ø–ø—ã —á–µ—Ä–µ–∑ Telegram Bot API. –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–∞—Ö —Å –∫—Ä–∞—Å–∏–≤—ã–º HTML-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏:

1. **`mcp_server/telegram_bot.py`** - –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram Bot API
   - –ö–ª–∞—Å—Å `TelegramBot` - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
   - –§—É–Ω–∫—Ü–∏—è `send_trading_signal()` - —É–¥–æ–±–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏

2. **`send_post.py`** - –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä—É—Å—Å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
   - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–Ω–∞–ª–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–∞–Ω–∞–ª—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

3. **`send_post_en.py`** - –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
   - –ê–Ω–∞–ª–æ–≥–∏—á–µ–Ω `send_post.py`, –Ω–æ —Å –∞–Ω–≥–ª–∏–π—Å–∫–∏–º —Ç–µ–∫—Å—Ç–æ–º

4. **`.telegram_chat_id`** - –§–∞–π–ª —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–º–∏ chat_id –∫–∞–Ω–∞–ª–æ–≤

---

## üîë –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –¢–æ–∫–µ–Ω –±–æ—Ç–∞:
```
BOT_TOKEN = "8003689195:AAGxQsopKvlLS34H2TZ0S1a0K7s4yV4iOBY"
```

### –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã:
- **DIAMOND HEADZH**: `-1003382613825` (–∫–∞–Ω–∞–ª)
- **Hypov Hedge Fund (AI Signals)**: `-1003484839912` (–∫–∞–Ω–∞–ª)

---

## üìö API –∏ —Ñ—É–Ω–∫—Ü–∏–∏

### –ö–ª–∞—Å—Å `TelegramBot`

#### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:
```python
from mcp_server.telegram_bot import TelegramBot

bot = TelegramBot(token="YOUR_BOT_TOKEN")
```

#### –ú–µ—Ç–æ–¥—ã:

**1. `send_message(chat_id, text, parse_mode="HTML", disable_web_page_preview=True)`**
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π —á–∞—Ç/–∫–∞–Ω–∞–ª
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
  - `chat_id` (str): ID —á–∞—Ç–∞ –∏–ª–∏ –∫–∞–Ω–∞–ª–∞
  - `text` (str): –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
  - `parse_mode` (str, optional): "HTML" –∏–ª–∏ "Markdown" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "HTML")
  - `disable_web_page_preview` (bool): –û—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–µ–≤—å—é —Å—Å—ã–ª–æ–∫
- **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** dict —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –æ—Ç Telegram API
- **–ü—Ä–∏–º–µ—Ä:**
```python
result = await bot.send_message(
    chat_id="-1003382613825",
    text="<b>–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è</b>",
    parse_mode="HTML"
)
```

**2. `get_updates(offset=None, timeout=10)`**
- –ü–æ–ª—É—á–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç –±–æ—Ç–∞ (–¥–ª—è –ø–æ–∏—Å–∫–∞ chat_id)
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
  - `offset` (int, optional): ID –ø–µ—Ä–≤–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
  - `timeout` (int): –¢–∞–π–º–∞—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
- **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** dict —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏

**3. `get_chat_info(chat_id)`**
- –ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —á–∞—Ç–µ/–∫–∞–Ω–∞–ª–µ
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
  - `chat_id` (str): ID —á–∞—Ç–∞
- **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** dict —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —á–∞—Ç–µ

**4. `close()`**
- –ó–∞–∫—Ä—ã–≤–∞–µ—Ç HTTP —Å–µ—Å—Å–∏—é
- **–í–∞–∂–Ω–æ:** –í—ã–∑—ã–≤–∞—Ç—å –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã

### –§—É–Ω–∫—Ü–∏—è `send_trading_signal()`

–£–¥–æ–±–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞:

```python
from mcp_server.telegram_bot import send_trading_signal

success = await send_trading_signal(
    token="YOUR_BOT_TOKEN",
    chat_id="-1003382613825",
    message="–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è"
)
```

---

## üîå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–æ—Ç–æ–º –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞ TelegramBot

```python
import asyncio
from mcp_server.telegram_bot import TelegramBot

async def publish_signal(signal_data, channels=None):
    """
    –ü—É–±–ª–∏–∫—É–µ—Ç —Ç–æ—Ä–≥–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã
    
    Args:
        signal_data: dict —Å –¥–∞–Ω–Ω—ã–º–∏ —Å–∏–≥–Ω–∞–ª–∞ (entry, sl, tp, etc.)
        channels: list chat_id –∫–∞–Ω–∞–ª–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—Å–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
    """
    BOT_TOKEN = "8003689195:AAGxQsopKvlLS34H2TZ0S1a0K7s4yV4iOBY"
    
    DEFAULT_CHANNELS = [
        "-1003382613825",  # DIAMOND HEADZH
        "-1003484839912",  # Hypov Hedge Fund (AI Signals)
    ]
    
    if channels is None:
        channels = DEFAULT_CHANNELS
    
    bot = TelegramBot(BOT_TOKEN)
    
    try:
        # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –¥–∞–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–∞
        message = format_trading_signal(signal_data)
        
        results = []
        for chat_id in channels:
            try:
                result = await bot.send_message(
                    chat_id=chat_id,
                    text=message,
                    parse_mode="HTML"
                )
                results.append({"chat_id": chat_id, "success": True})
            except Exception as e:
                results.append({"chat_id": chat_id, "success": False, "error": str(e)})
        
        return results
    finally:
        await bot.close()

def format_trading_signal(data):
    """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª–∞ –≤ HTML —Å–æ–æ–±—â–µ–Ω–∏–µ"""
    return f"""<b>‚ö° TRADING SIGNAL</b>

<b>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</b>

<b>üìä {data['symbol']}</b>

<b>Entry:</b> ${data['entry']}
<b>Stop-Loss:</b> ${data['stop_loss']}
<b>Take-Profit:</b> ${data['take_profit']}

<b>Risk/Reward:</b> {data['risk_reward']}

<b>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</b>"""
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–æ—Ç–æ–≤—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π

```python
from mcp_server.telegram_bot import TelegramBot

# –®–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ send_post.py –∏ send_post_en.py
# –ú–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–∏

RUSSIAN_TEMPLATE = """<b>‚ö° –î–ï–¢–ê–õ–¨–ù–´–ô –ü–õ–ê–ù –°–î–ï–õ–û–ö</b>
..."""

ENGLISH_TEMPLATE = """<b>‚ö° DETAILED TRADING PLAN</b>
..."""

async def publish_multiple_signals(signals, language="en"):
    """–ü—É–±–ª–∏–∫—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–∏–≥–Ω–∞–ª–æ–≤"""
    bot = TelegramBot(BOT_TOKEN)
    
    template = ENGLISH_TEMPLATE if language == "en" else RUSSIAN_TEMPLATE
    
    for signal in signals:
        message = format_signal_from_template(template, signal)
        for chat_id in DEFAULT_CHANNELS:
            await bot.send_message(chat_id, message, parse_mode="HTML")
    
    await bot.close()
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ MCP –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

–ï—Å–ª–∏ –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç MCP –ø—Ä–æ—Ç–æ–∫–æ–ª, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤ `mcp_server/full_server.py`:

```python
@tool()
async def publish_trading_signal_to_telegram(
    symbol: str,
    entry: float,
    stop_loss: float,
    take_profit: float,
    risk_reward: str,
    channels: List[str] = None,
    language: str = "en"
) -> dict:
    """
    –ü—É–±–ª–∏–∫—É–µ—Ç —Ç–æ—Ä–≥–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª –≤ Telegram –∫–∞–Ω–∞–ª—ã
    
    Args:
        symbol: –¢–æ—Ä–≥–æ–≤–∞—è –ø–∞—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "ZEN/USDT")
        entry: –¶–µ–Ω–∞ –≤—Ö–æ–¥–∞
        stop_loss: –°—Ç–æ–ø-–ª–æ—Å—Å
        take_profit: –¢–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç
        risk_reward: –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ä–∏—Å–∫/–Ω–∞–≥—Ä–∞–¥–∞
        channels: –°–ø–∏—Å–æ–∫ chat_id –∫–∞–Ω–∞–ª–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        language: –Ø–∑—ã–∫ —Å–æ–æ–±—â–µ–Ω–∏—è ("en" –∏–ª–∏ "ru")
    
    Returns:
        dict: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–ø—Ä–∞–≤–∫–∏
    """
    from mcp_server.telegram_bot import TelegramBot
    
    BOT_TOKEN = "8003689195:AAGxQsopKvlLS34H2TZ0S1a0K7s4yV4iOBY"
    DEFAULT_CHANNELS = ["-1003382613825", "-1003484839912"]
    
    if channels is None:
        channels = DEFAULT_CHANNELS
    
    bot = TelegramBot(BOT_TOKEN)
    
    try:
        # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        message = create_signal_message(
            symbol, entry, stop_loss, take_profit, risk_reward, language
        )
        
        results = []
        for chat_id in channels:
            try:
                await bot.send_message(chat_id, message, parse_mode="HTML")
                results.append({"chat_id": chat_id, "status": "success"})
            except Exception as e:
                results.append({"chat_id": chat_id, "status": "error", "error": str(e)})
        
        return {"results": results, "total": len(channels), "success": len([r for r in results if r["status"] == "success"])}
    finally:
        await bot.close()
```

---

## üìù –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π

### HTML —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç HTML —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è:

- `<b>—Ç–µ–∫—Å—Ç</b>` - –∂–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç
- `<code>–∫–æ–¥</code>` - –º–æ–Ω–æ—à–∏—Ä–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
- `‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ` - —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏
- –≠–º–æ–¥–∑–∏ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è:

1. **–ó–∞–≥–æ–ª–æ–≤–æ–∫** - –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞
2. **–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å**
3. **–î–µ—Ç–∞–ª–∏ —Å–¥–µ–ª–∫–∏** - Entry, SL, TP, R:R
4. **–†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏**
5. **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫–Ω–∞**
6. **–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å**
7. **–†–∏—Å–∫ –ø–æ—Ä—Ç—Ñ–µ–ª—è** (–µ—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–¥–µ–ª–æ–∫)
8. **Confidence –∞–Ω–∞–ª–∏–∑**
9. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**

---

## üîß –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –û—Ç–ø—Ä–∞–≤–∫–∞ –æ–¥–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞

```python
import asyncio
from mcp_server.telegram_bot import TelegramBot

async def send_single_signal():
    bot = TelegramBot("8003689195:AAGxQsopKvlLS34H2TZ0S1a0K7s4yV4iOBY")
    
    message = """<b>‚ö° TRADING SIGNAL</b>
    
<b>üìä ZEN/USDT</b>
<b>Entry:</b> $15.89
<b>Stop-Loss:</b> $13.58
<b>Take-Profit:</b> $20.52"""
    
    await bot.send_message("-1003382613825", message, parse_mode="HTML")
    await bot.close()

asyncio.run(send_single_signal())
```

### –ü—Ä–∏–º–µ—Ä 2: –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–Ω–∞–ª–æ–≤

```python
async def send_to_multiple_channels():
    bot = TelegramBot("8003689195:AAGxQsopKvlLS34H2TZ0S1a0K7s4yV4iOBY")
    
    channels = ["-1003382613825", "-1003484839912"]
    message = "–í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"
    
    for chat_id in channels:
        await bot.send_message(chat_id, message, parse_mode="HTML")
    
    await bot.close()
```

### –ü—Ä–∏–º–µ—Ä 3: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è

```python
def create_signal_message(symbol, entry, sl, tp, rr, language="en"):
    """–°–æ–∑–¥–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ –¥–∞–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–∞"""
    
    if language == "en":
        return f"""<b>‚ö° TRADING SIGNAL</b>

<b>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</b>

<b>üìä {symbol}</b>

<b>Entry:</b> ${entry}
<b>Stop-Loss:</b> ${sl}
<b>Take-Profit:</b> ${tp}

<b>Risk/Reward:</b> {rr}

<b>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</b>"""
    else:
        return f"""<b>‚ö° –¢–û–†–ì–û–í–´–ô –°–ò–ì–ù–ê–õ</b>

<b>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</b>

<b>üìä {symbol}</b>

<b>Entry:</b> ${entry}
<b>Stop-Loss:</b> ${sl}
<b>Take-Profit:</b> ${tp}

<b>Risk/Reward:</b> {rr}

<b>‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</b>"""
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–∞–Ω–∞–ª–æ–≤

–ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∫–∞–Ω–∞–ª:

1. –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ –∫–∞–Ω–∞–ª –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª
3. –ü–æ–ª—É—á–∏—Ç–µ chat_id —á–µ—Ä–µ–∑ `get_updates()`:
```python
bot = TelegramBot(BOT_TOKEN)
updates = await bot.get_updates()
# –ù–∞–π–¥–∏—Ç–µ chat_id –≤ updates
```
4. –î–æ–±–∞–≤—å—Ç–µ chat_id –≤ `DEFAULT_CHANNELS` –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–±—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –±–µ–∑ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–µ HTML:

```python
try:
    await bot.send_message(chat_id, message, parse_mode="HTML")
except Exception as e:
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –Ω–∞ –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç
    await bot.send_message(chat_id, message, parse_mode=None)
```

### 3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `loguru` –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
```python
from loguru import logger

logger.info("–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ")
logger.error("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏")
```

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ async/await** - –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ
2. **–í—Å–µ–≥–¥–∞ –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ —Å–µ—Å—Å–∏—é** - –≤—ã–∑—ã–≤–∞–π—Ç–µ `await bot.close()` –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
3. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏** - Telegram API –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É
4. **–ö—ç—à–∏—Ä—É–π—Ç–µ chat_id** - –Ω–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–π—Ç–µ –∏—Ö –∫–∞–∂–¥—ã–π —Ä–∞–∑
5. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTML —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –æ–Ω–æ –¥–∞–µ—Ç –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
6. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–∏–º–∏—Ç—ã API** - Telegram –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç—ã –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∂–µ –µ—Å—Ç—å –≤ `requirements.txt`:
- `aiohttp>=3.9.0` - –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- `loguru>=0.7.0` - –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ:**
- –¢–æ–∫–µ–Ω –±–æ—Ç–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –∫–æ–¥–µ (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è)
- Chat_id –∫–∞–Ω–∞–ª–æ–≤ –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º —Ñ–∞–π–ª–µ
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `.env` —Ñ–∞–π–ª –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —á–µ—Ä–µ–∑ `loguru`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –±–æ—Ç –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤ –∫–∞–Ω–∞–ª–∞—Ö
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ chat_id –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞ –¥–ª—è –∫–∞–Ω–∞–ª–æ–≤)

---

## üìÑ –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

```python
"""
–ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –±–æ—Ç–æ–º –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∞–Ω–∞–ª–∏–∑–∞
"""
import asyncio
from typing import List, Dict, Optional
from mcp_server.telegram_bot import TelegramBot

class TelegramPublisher:
    """–ö–ª–∞—Å—Å –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ Telegram"""
    
    def __init__(self, bot_token: str, default_channels: List[str] = None):
        self.bot_token = bot_token
        self.default_channels = default_channels or [
            "-1003382613825",
            "-1003484839912"
        ]
        self.bot = None
    
    async def __aenter__(self):
        self.bot = TelegramBot(self.bot_token)
        return self
    
    async def __aexit__(self, exc_type, exc_val, exc_tb):
        if self.bot:
            await self.bot.close()
    
    async def publish_signal(
        self,
        symbol: str,
        entry: float,
        stop_loss: float,
        take_profit: float,
        risk_reward: str,
        additional_info: Optional[Dict] = None,
        channels: Optional[List[str]] = None,
        language: str = "en"
    ) -> Dict:
        """
        –ü—É–±–ª–∏–∫—É–µ—Ç —Ç–æ—Ä–≥–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª
        
        Returns:
            dict: {"success": bool, "sent_to": List[str], "errors": List[str]}
        """
        if channels is None:
            channels = self.default_channels
        
        message = self._format_message(
            symbol, entry, stop_loss, take_profit, risk_reward,
            additional_info, language
        )
        
        results = {
            "success": True,
            "sent_to": [],
            "errors": []
        }
        
        for chat_id in channels:
            try:
                await self.bot.send_message(chat_id, message, parse_mode="HTML")
                results["sent_to"].append(chat_id)
            except Exception as e:
                results["success"] = False
                results["errors"].append(f"{chat_id}: {str(e)}")
        
        return results
    
    def _format_message(
        self,
        symbol: str,
        entry: float,
        stop_loss: float,
        take_profit: float,
        risk_reward: str,
        additional_info: Optional[Dict],
        language: str
    ) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ"""
        # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        # –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω—ã –∏–∑ send_post.py –∏–ª–∏ send_post_en.py
        pass

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
async def main():
    async with TelegramPublisher("YOUR_BOT_TOKEN") as publisher:
        result = await publisher.publish_signal(
            symbol="ZEN/USDT",
            entry=15.89,
            stop_loss=13.58,
            take_profit=20.52,
            risk_reward="1:2.0",
            language="en"
        )
        print(result)

asyncio.run(main())
```

---

**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-13  
**–ê–≤—Ç–æ—Ä:** AI Trading Assistant


