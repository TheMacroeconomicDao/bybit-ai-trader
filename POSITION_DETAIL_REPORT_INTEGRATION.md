# üìä Position Detail Report - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

## –û–±–∑–æ—Ä

–î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –ø–æ–∑–∏—Ü–∏–∏ —Å real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏, TradingView –≥—Ä–∞—Ñ–∏–∫–æ–º –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º –∞–Ω–∞–ª–∏–∑–æ–º.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

1. **PositionDetailReport.ts** - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç—á–µ—Ç–∞
   - –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ: `bybit-mcp/webui/src/components/PositionDetailReport.ts`
   - –¢–∏–ø: TypeScript –∫–ª–∞—Å—Å (Vanilla JS)
   - Singleton: `positionDetailReport`

2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TradingDashboard**
   - –ö–Ω–æ–ø–∫–∞ "üìä View Full Report" –≤ –¥–µ—Ç–∞–ª—å–Ω–æ–π –ø–∞–Ω–µ–ª–∏ –ø–æ–∑–∏—Ü–∏–∏
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∫–ª–∏–∫–µ

3. **Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**
   - –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ `tradingDataService` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –ø–æ–∑–∏—Ü–∏–∏
   - WebSocket –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Ü–µ–Ω—ã
   - –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

```typescript
interface PositionDetailData {
  // –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–∑–∏—Ü–∏–∏
  symbol: string;
  side: 'Buy' | 'Sell';
  size: number;
  entry_price: number;
  current_price: number;
  unrealized_pnl: number;
  unrealized_pnl_pct: number;
  leverage?: number;
  stop_loss?: number;
  take_profit?: number;
  time_in_trade?: string;
  status?: 'healthy' | 'warning' | 'critical';
  
  // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  technicalAnalysis?: any;  // –†–µ–∑—É–ª—å—Ç–∞—Ç analyze_asset
  marketData?: any;         // –†–µ–∑—É–ª—å—Ç–∞—Ç get_asset_price
  riskMetrics?: {
    risk_pct: number;
    liquidation_distance: number;
    margin_ratio: number;
  };
}
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û—Ç–∫—Ä—ã—Ç–∏–µ –æ—Ç—á–µ—Ç–∞ –∏–∑ TradingDashboard

```typescript
// –í TradingDashboard —É–∂–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ:
// –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –ø–æ–∑–∏—Ü–∏—é ‚Üí –∫–Ω–æ–ø–∫–∞ "View Full Report" ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
```

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ

```typescript
import { positionDetailReport } from '@/components/PositionDetailReport';
import { tradingDataService } from '@/services/tradingDataService';

// –ü–æ–ª—É—á–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é
const position = tradingDataService.getPosition('BTCUSDT');

// –û—Ç–∫—Ä—ã—Ç—å –æ—Ç—á–µ—Ç
if (position) {
  await positionDetailReport.openPosition(position);
}
```

### –ó–∞–∫—Ä—ã—Ç–∏–µ –æ—Ç—á–µ—Ç–∞

```typescript
// –ó–∞–∫—Ä—ã—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ
positionDetailReport.close();

// –ò–ª–∏ –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "‚úï –ó–∞–∫—Ä—ã—Ç—å" –≤ sticky –ø–∞–Ω–µ–ª–∏
// –ò–ª–∏ –Ω–∞–∂–∞—Ç—å Escape
```

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### 1. Sticky Position Panel
- –í—Å–µ–≥–¥–∞ –≤–∏–¥–Ω–∞ –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç: —Å–∏–º–≤–æ–ª, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É, PnL
- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è

### 2. TradingView –ì—Ä–∞—Ñ–∏–∫
- –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤: 15m, 1h, 4h, 1D
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã: RSI, MACD, Volume
- –ú–∞—Ä–∫–µ—Ä—ã –ø–æ–∑–∏—Ü–∏–∏: Entry, Current, SL, TP

### 3. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ MCP tool `analyze_asset`
- –ê–Ω–∞–ª–∏–∑ –Ω–∞ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö: 15m, 1h, 4h
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
  - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (RSI, MACD, ADX)
  - –°–∏–≥–Ω–∞–ª—ã (BUY/SELL/HOLD)
  - –£—Ä–æ–≤–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è
  - –ö–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π —Å–∏–≥–Ω–∞–ª

### 4. –†—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ MCP tool `get_asset_price`
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
  - –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞
  - –ò–∑–º–µ–Ω–µ–Ω–∏–µ 24—á
  - –û–±—ä–µ–º 24—á
  - High/Low 24—á

### 5. –†–∏—Å–∫-–º–µ—Ç—Ä–∏–∫–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç:
  - –†–∏—Å–∫ –ø–æ–∑–∏—Ü–∏–∏ (% –æ—Ç –±–∞–ª–∞–Ω—Å–∞)
  - –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∞—Ä–∂–∏

## Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –ü–æ–¥–ø–∏—Å–∫–∏

1. **Position updates** - —á–µ—Ä–µ–∑ `tradingDataService.subscribe('position:SYMBOL')`
2. **Price updates** - —á–µ—Ä–µ–∑ `websocketService.on('price_update')`
3. **Auto-refresh** - –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥

### –û–±–Ω–æ–≤–ª—è–µ–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

- Sticky –ø–∞–Ω–µ–ª—å (—Ü–µ–Ω–∞, PnL)
- Position card (–≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏)
- Risk metrics (–ø–µ—Ä–µ—Å—á–µ—Ç –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ü–µ–Ω—ã)

## –°—Ç–∏–ª–∏

–°—Ç–∏–ª–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ `loadStyles()` –º–µ—Ç–æ–¥.
–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤:
- `bybit-mcp/webui/src/styles/main.css`
- `bybit-mcp/webui/src/styles/trading-terminal.css`

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ TradingTerminal

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ TradingTerminal:

```typescript
// –í TradingTerminal.ts
import { positionDetailReport } from './PositionDetailReport';

// –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –ø–æ–∑–∏—Ü–∏—é –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
private onPositionClick(position: Position): void {
  positionDetailReport.openPosition(position);
}
```

## MCP Tools –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ

1. **analyze_asset** - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
   ```typescript
   await mcpClient.callTool('analyze_asset', {
     symbol: 'BTCUSDT',
     timeframes: ['15m', '1h', '4h'],
     include_patterns: true
   });
   ```

2. **get_asset_price** - —Ä—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
   ```typescript
   await mcpClient.callTool('get_asset_price', {
     symbol: 'BTCUSDT'
   });
   ```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- –ü—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ TradingView - –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- Debounced –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ `tradingDataService`
- –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- TradingView –≤–∏–¥–∂–µ—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –æ—Ç—á–µ—Ç–∞

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. ‚úÖ Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
2. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TradingDashboard
3. ‚è≥ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≥—Ä–∞—Ñ–∏–∫–∞
4. ‚è≥ –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–∞ –≤ PDF
5. ‚è≥ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ–∑–∏—Ü–∏–∏
6. ‚è≥ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤–∞–∂–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –û—Ç–∫—Ä—ã—Ç—å TradingDashboard
2. –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –ø–æ–∑–∏—Ü–∏—é
3. –ù–∞–∂–∞—Ç—å "üìä View Full Report"
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
   - –ó–∞–≥—Ä—É–∑–∫—É –≥—Ä–∞—Ñ–∏–∫–∞
   - –ó–∞–≥—Ä—É–∑–∫—É —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
   - Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—ã
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ PnL

## Troubleshooting

### –ì—Ä–∞—Ñ–∏–∫ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ TradingView script –∑–∞–≥—Ä—É–∂–µ–Ω
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MCP —Å–µ—Ä–≤–µ—Ä—É
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å tool `analyze_asset`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏

### Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏ –≤ `tradingDataService`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –æ—à–∏–±–∫–∏


